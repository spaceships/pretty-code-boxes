\documentclass{article}

\usepackage{environ}
\usepackage{varwidth}
\usepackage{tikz}
\usetikzlibrary{fit, positioning, backgrounds}

\NewEnviron{codebox}[1]{%
    \begin{tikzpicture}
        \node (header) [] {#1};
        \node (body) [below=.1em of header] {
            \begin{varwidth}{\linewidth}%
                \upshape%   no slant in definition/theorem statement!
                \begin{tabbing}%
                    \quad\=\quad\=\quad\=\quad\=\kill
                    \BODY
                \end{tabbing}%
            \end{varwidth}%
        };
        \node (outline) [fit=(header)(body), draw] {};
        \draw (outline.west |- header.south) -- (outline.east |- header.south);
        \begin{scope}[on background layer]
            \fill [black!2] (outline.north west) rectangle (outline.south east |- header.south);
        \end{scope}
    \end{tikzpicture}
}

\newcommand{\comment}[1]{\sl\small\color{black!50} \mbox{ // #1 }}

\begin{document}

\begin{codebox}{$\mathsf{Gb}'(C, \{s_i\}_{i \in [q^{2d}]}, x_1, \delta_1, \cdots, x_n, \delta_n)$}
    \comment{Combine the \delta{}s using addition}\\
    $\Delta = \{ \sum_{j \in [\lambda]}  \delta_{i,j} \}_{i \in [n]}$\\
    \\
    \comment{Combine the seeds using \Delta}\\
    $r = \bigoplus_{i \in [\lambda]} s_{\Delta_i}$\\
    \\
    \comment{Call \textsf{Gb} and \textsf{En} using $r$}\\
    return $\textsf{Gb}(C; r),\, \textsf{En}(x_1 || \dots || x_n; r)$
\end{codebox}

\end{document}
